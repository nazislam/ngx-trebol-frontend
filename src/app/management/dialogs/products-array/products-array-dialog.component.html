<!--
  Copyright (c) 2021 The TrÃ©bol eCommerce Project

  This software is released under the MIT License.
  https://opensource.org/licenses/MIT
-->

<h2 mat-dialog-title i18n="Title of dialog prompt to add products into details of a sell">Add Products</h2>
<app-centered-mat-spinner *ngIf="loading$ | async">
</app-centered-mat-spinner>

<div [hidden]="loading$ | async">
  <mat-expansion-panel [expanded]="true">

    <mat-expansion-panel-header
      i18n="Title of widget displaying available products for addition to details of a sell">Available Products</mat-expansion-panel-header>

    <app-product-filters-panel (filtersChanges)="onFiltersChange($event)">
    </app-product-filters-panel>

    <div class="product-table-wrapper">
      <table mat-table [dataSource]="filteredProductsArray$">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef
            i18n="product name|Name of table header for name of product">Name</th>
          <td mat-cell *matCellDef="let product">
            {{ product.name }}
          </td>
        </ng-container>
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef
            i18n="Name of table header for price per product unit">Price</th>
          <td mat-cell *matCellDef="let product">
            ${{ product.price }}
          </td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> </th>
          <td mat-cell *matCellDef="let product">
            <button mat-button mat-icon-button type="button"
              color="primary"
              aria-label="Add this product"
              i18n-aria-label="add this product|Label for action button to mark a product for addition to details of a sell"
              (click)="onClickIncludeProduct(product)">
              <mat-icon>add</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="productTableColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: productTableColumns;"></tr>
      </table>
    </div>

  </mat-expansion-panel>
</div>

<mat-card>

  <mat-card-header>
    <mat-card-title
      i18n="Title of widget displaying products marked for addition to details of a sell">Selected Products</mat-card-title>
  </mat-card-header>

  <mat-card-content class="product-table-wrapper">
    <table mat-table [dataSource]="productsArray$">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef
          i18n="product name|Name of table header for name of product">Name</th>
        <td mat-cell *matCellDef="let product">
          {{ product.name }}
        </td>
      </ng-container>
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef
          i18n="Name of table header for price per product unit">Price</th>
        <td mat-cell *matCellDef="let product">
          ${{ product.price }}
        </td>
      </ng-container>
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> </th>
        <td mat-cell *matCellDef="let i=index">
          <div class="acciones">
            <button mat-button mat-icon-button type="button"
              color="warn"
              aria-label="Don't add this product"
              i18n-aria-label="dont add this product|Label for action button to unmark a product for addition details of a sell"
              (click)="onClickDropProduct(i)">
              <mat-icon>remove</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="productTableColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: productTableColumns;"></tr>
    </table>
  </mat-card-content>
</mat-card>
<div class="actions">
  <button mat-button mat-raised-button type="button"
    color="primary"
    [disabled]="isArrayEmpty$ | async"
    [mat-dialog-close]="productsArray$ | async"
    i18n="confirm|Label for action button to accept and proceed">Confirm</button>
  <button mat-button mat-raised-button type="button"
    [mat-dialog-close]="[]"
    i18n="cancel|Label for action button to cancel and/or stop an operation">Cancel</button>
</div>
